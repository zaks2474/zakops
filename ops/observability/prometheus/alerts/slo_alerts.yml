groups:
- name: slo_alerts
  interval: 30s
  rules:
  - alert: api_availability_breach
    expr: (sum(rate(http_requests_total{service="api",status_code=~"[23].."}[5m]))
      / sum(rate(http_requests_total{service="api"}[5m]))) * 100 < 99.5
    for: 5m
    labels:
      severity: critical
      slo_id: api_availability
      service: api
    annotations:
      summary: API Availability below target
      description: Availability is below 99.5% target for api
  - alert: api_latency_p95_breach
    expr: histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{service="api"}[5m]))
      by (le)) * 1000 > 500
    for: 5m
    labels:
      severity: warning
      slo_id: api_latency_p95
      service: api
    annotations:
      summary: API Latency P95 exceeded
      description: Latency P95 exceeds 500ms for api
  - alert: api_latency_p99_breach
    expr: histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{service="api"}[5m]))
      by (le)) * 1000 > 2000
    for: 5m
    labels:
      severity: warning
      slo_id: api_latency_p99
      service: api
    annotations:
      summary: API Latency P99 exceeded
      description: Latency P99 exceeds 2000ms for api
  - alert: api_error_rate_breach
    expr: (sum(rate(http_requests_total{service="api",status_code=~"5.."}[5m])) /
      sum(rate(http_requests_total{service="api"}[5m]))) * 100 > 0.1
    for: 5m
    labels:
      severity: critical
      slo_id: api_error_rate
      service: api
    annotations:
      summary: API Error Rate exceeded
      description: Error rate exceeds 0.1% for api
  - alert: agent_availability_breach
    expr: (sum(rate(http_requests_total{service="agent",status_code=~"[23].."}[5m]))
      / sum(rate(http_requests_total{service="agent"}[5m]))) * 100 < 99.0
    for: 5m
    labels:
      severity: critical
      slo_id: agent_availability
      service: agent
    annotations:
      summary: Agent Availability below target
      description: Availability is below 99.0% target for agent
  - alert: agent_latency_p95_breach
    expr: histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{service="agent"}[5m]))
      by (le)) * 1000 > 5000
    for: 5m
    labels:
      severity: warning
      slo_id: agent_latency_p95
      service: agent
    annotations:
      summary: Agent Latency P95 exceeded
      description: Latency P95 exceeds 5000ms for agent
  - alert: agent_tool_accuracy_breach
    expr: golden_trace_pass_rate{service="agent"} * 100 < 95
    for: 1h
    labels:
      severity: critical
      slo_id: agent_tool_accuracy
      service: agent
    annotations:
      summary: Agent Tool Accuracy below target
      description: Accuracy is below 95% for agent
